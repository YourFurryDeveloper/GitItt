<!DOCTYPE html>

<html>
    <head>
        <title>GitItt |</title>
        <link rel="stylesheet" href="styles_thread.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>

    <body onload="fetchData()">
        <div id="topbar">
            <p id="sitename">GitItt</p>
            <nav id="topnav">
                <a href="index.html"><button id="navbtn">Home</button></a>
                <a href="reccomended.html"><button id="navbtn">Reccomended</button></a>
                <a href="user-submitted.html"><button id="navbtn">User-Submitted</button></a>
            </nav>
        </div>
        <br>
        <br>
        <br>
        <div id="threadinfo">
            <h1 id="threadname"></h1>
        </div>
        <br>
        <div class="giscus" id="giscus"></div>

        <script>
            function fetchData() {
                const params = new URLSearchParams(window.location.search);
                const threadname = params.get("thread");

                document.getElementById("threadname").innerHTML = `G/${threadname}`;
                document.title = `GitItt | ${threadname}`

                imageExists(`https://yourfurrydeveloper.github.io/GitItt/banner_imgs/${threadname}.png`, function(exists) {
                    if (exists) {
                        document.getElementById("threadinfo").style.backgroundImage = `url('https://yourfurrydeveloper.github.io/GitItt/banner_imgs/${threadname}.png')`
                    }
                });

                imageExists(`https://yourfurrydeveloper.github.io/GitItt/banner_imgs/${threadname}.jpg`, function(exists) {
                    if (exists) {
                        document.getElementById("threadinfo").style.backgroundImage = `url('https://yourfurrydeveloper.github.io/GitItt/banner_imgs/${threadname}.jpg')`
                    }
                });

                loadGiscus();
            }

            function imageExists(url, callback) {
                const img = new Image();
                img.onload = () => callback(true);
                img.onerror = () => callback(false);
                img.src = url;
            }


            function loadGiscus() {
                const giscusContainer = document.getElementById('giscus');

                const script = document.createElement('script');
                script.src = 'https://giscus.app/client.js';
                script.setAttribute('data-repo', 'YourFurryDeveloper/GitItt');
                script.setAttribute('data-repo-id', 'R_kgDOO2qTdA');
                script.setAttribute('data-category', 'General');
                script.setAttribute('data-category-id', 'DIC_kwDOO2qTdM4CrE_E');
                script.setAttribute('data-mapping', 'title');
                script.setAttribute('data-strict', '0');
                script.setAttribute('data-reactions-enabled', '0');
                script.setAttribute('data-emit-metadata', '0');
                script.setAttribute('data-input-position', 'top');
                script.setAttribute('data-theme', 'preferred_color_scheme');
                script.setAttribute('data-lang', 'en');
                script.setAttribute('data-loading', 'lazy');
                script.setAttribute('crossorigin', 'anonymous');
                script.async = true;

                giscusContainer.appendChild(script);
            }
        </script>
    </body>
</html>
